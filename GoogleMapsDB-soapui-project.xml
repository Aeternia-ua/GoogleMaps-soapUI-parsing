<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project activeEnvironment="Default" name="GoogleMapsDB" resourceRoot="" soapui-version="5.0.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://maps.googleapis.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://maps.googleapis.com</con:endpoint></con:endpoints><con:resource name="TimeServ" path="/maps/api/timezone/{responsetype}"><con:settings/><con:parameters><con:parameter><con:name>responsetype</con:name><con:value>json</con:value><con:style>TEMPLATE</con:style><con:default>json</con:default><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="getJson" method="GET"><con:settings/><con:parameters><con:parameter><con:name>location</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter><con:parameter><con:name>timestamp</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter></con:parameters><con:representation type="FAULT"><con:mediaType>text/html; charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:maps="https://maps.googleapis.com/">maps:Response</con:element></con:representation><con:request name="getTime" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Accept" value="application/json:charset=UTF-8" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>https://maps.googleapis.com</con:endpoint><con:request/><con:originalUri>https://maps.googleapis.com/</con:originalUri><con:credentials><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>Global HTTP Settings</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="timestamp" value="1331161200"/>
  <con:entry key="location" value="41.3833333,2.1833333"/>
</con:parameters><con:parameterOrder><con:entry>responsetype</con:entry><con:entry>location</con:entry><con:entry>timestamp</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite name="TimezoneTestSuite"><con:description>TestSuite generated for REST Service [https://maps.googleapis.com]</con:description><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Json TestCase" searchProperties="true" id="a0f0e524-ce71-422e-9b91-83e249f33e17"><con:description>TestCase generated for REST Resource [Json] located at [/maps/api/timezone/{responsetype}]</con:description><con:settings/><con:testStep type="restrequest" name="TimeGetRequest"><con:settings/><con:config service="https://maps.googleapis.com" resourcePath="/maps/api/timezone/{responsetype}" methodName="getJson" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="TimeGetRequest" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Accept" value="application/json:charset=UTF-8" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>https://maps.googleapis.com</con:endpoint><con:request/><con:originalUri>https://maps.googleapis.com/</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>declare namespace ns1='https://maps.googleapis.com/';
//ns1:status</path><content>OK</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>Global HTTP Settings</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="timestamp" value="1331161200"/>
  <con:entry key="location" value="41.3833333,2.1833333"/>
</con:parameters><con:parameterOrder><con:entry>responsetype</con:entry><con:entry>location</con:entry><con:entry>timestamp</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="JDBC Request1"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://127.0.0.1:3306/timezone?user=root&amp;password=1111</con:connectionString><con:query>SELECT * FROM timezone.madridtime;</con:query><con:assertion type="JDBC Status" name="JDBC Status"/><con:assertion type="JDBC Timeout" name="JDBC Timeout"/><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>import com.eviware.soapui.support.xml.XmlUtils;
import org.w3c.dom.Document;

Document xml = XmlUtils.parseXml(messageExchange.getResponseContentAsXml());
int xmlSize = xml.getElementsByTagName("Row").getLength();
for (int i = 0; i &lt; xmlSize; i++) {
	String iTimeZoneIdProperty = xml.getElementsByTagName("MADRIDTIME.TIMEZONEID").item(0).getTextContent();
	String iTimeZoneNameProperty = xml.getElementsByTagName("MADRIDTIME.TIMEZONENAME").item(0).getTextContent();
	String iTimeStampProperty = xml.getElementsByTagName("MADRIDTIME.TIMESTAMP").item(0).getTextContent();
	String iLatProperty = xml.getElementsByTagName("MADRIDTIME.LAT").item(0).getTextContent();
	String iLngProperty = xml.getElementsByTagName("MADRIDTIME.LNG").item(0).getTextContent();

	context.getTestCase().getTestStepByName("ExpectedProperties").setPropertyValue("TimeZoneId"+i,  iTimeZoneIdProperty);	
	context.getTestCase().getTestStepByName("ExpectedProperties").setPropertyValue("TimeZoneName"+i,  iTimeZoneNameProperty);
	context.getTestCase().getTestStepByName("ExpectedProperties").setPropertyValue("TimeStamp"+i,  iTimeStampProperty);		
	context.getTestCase().getTestStepByName("ExpectedProperties").setPropertyValue("Lat"+i,  iLatProperty);	
	context.getTestCase().getTestStepByName("ExpectedProperties").setPropertyValue("Lng"+i, iLngProperty);	
}</scriptText></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="groovy" name="SetRequestProps"><con:settings/><con:config><script>int propsSize = context.getTestCase().getTestStepByName("ExpectedProperties").getProperties().size() / 4;
StringBuilder getRequestParam = new StringBuilder("");

for (int i=0; i &lt; propsSize; i++) {
	String lat = context.getTestCase().getTestStepByName("ExpectedProperties").getPropertyValue("Lat"+i);
	String lng = context.getTestCase().getTestStepByName("ExpectedProperties").getPropertyValue("Lng"+i);
	getRequestParam.append(lat + "," + lng );
	if (i != propsSize-1) {
			getRequestParam.append("|")
	}
}

context.getTestCase().getTestStepByName("TimeGetRequest").setPropertyValue("location", getRequestParam.toString());
log.info(getRequestParam.toString())</script></con:config></con:testStep><con:testStep type="properties" name="ExpectedProperties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>TimeZoneId0</con:name><con:value>Europe/Madrid</con:value></con:property><con:property><con:name>TimeZoneName0</con:name><con:value>Central European Standard Time</con:value></con:property><con:property><con:name>TimeStamp0</con:name><con:value>1331161200</con:value></con:property><con:property><con:name>Lat0</con:name><con:value>41.3833333</con:value></con:property><con:property><con:name>Lng0</con:name><con:value>2.1833333</con:value></con:property></con:properties></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:sensitiveInformation/></con:soapui-project>
